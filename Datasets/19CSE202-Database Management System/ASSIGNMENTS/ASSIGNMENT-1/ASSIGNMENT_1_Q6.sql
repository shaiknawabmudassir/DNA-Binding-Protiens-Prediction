USE ASSIGNMENT_1;
CREATE TABLE EMPLOYEE (
    ID INTEGER PRIMARY KEY,
    NAME VARCHAR(20) NOT NULL,
    SALARY INTEGER NOT NULL,
    DEPARTMENT_ID INTEGER NOT NULL
);
CREATE TABLE DEPARTMENT (
    ID INTEGER PRIMARY KEY,
    NAME VARCHAR(20) NOT NULL
);
INSERT INTO EMPLOYEE()
VALUES(1, 'JOE', 70000, 1),
	(2, 'JIM', 90000, 1),
	(3, 'HENRY', 80000, 2),
      (4, 'SAM', 60000, 2),
      (5, 'MAX', 90000, 1);
INSERT INTO DEPARTMENT()
VALUES(1, 'IT'),
      (2, 'SALES');

SELECT
    DEPARTMENT.NAME AS 'Department',
    EMPLOYEE.NAME AS 'Employee',
    SALARY
FROM
    EMPLOYEE
        JOIN
    DEPARTMENT ON EMPLOYEE.DEPARTMENT_ID= Department.id
WHERE
    (EMPLOYEE.DEPARTMENT_ID , SALARY) IN
    (   SELECT
            DEPARTMENT_ID, MAX(SALARY)
        FROM
            Employee
        GROUP BY DEPARTMENT_ID
    )
;